require 'spec_helper'

one_serie_json = <<-JS
{
  "xtab_data": {
    "columns": {
      "tree": {
        "index": {
          "24128": [
            0
          ],
          "24129": [
            1
          ],
          "24130": [
            2
          ],
          "24131": [
            3
          ],
          "24132": [
            4
          ],
          "24133": [
            5
          ],
          "24134": [
            6
          ],
          "24135": [
            7
          ],
          "24136": [
            8
          ],
          "24137": [
            9
          ],
          "24138": [
            10
          ],
          "24139": [
            11
          ],
          "24140": [
            12
          ],
          "24141": [
            13
          ],
          "24142": [
            14
          ],
          "24143": [
            15
          ],
          "24144": [
            16
          ],
          "24145": [
            17
          ],
          "24146": [
            18
          ],
          "24147": [
            19
          ],
          "24148": [
            20
          ],
          "24149": [
            21
          ],
          "24150": [
            22
          ],
          "24151": [
            23
          ],
          "24152": [
            24
          ],
          "24153": [
            25
          ],
          "24154": [
            26
          ],
          "24155": [
            27
          ],
          "24156": [
            28
          ],
          "24157": [
            29
          ],
          "24158": [
            30
          ],
          "24159": [
            31
          ],
          "24160": [
            32
          ],
          "24161": [
            33
          ],
          "24162": [
            34
          ],
          "24163": [
            35
          ],
          "24164": [
            36
          ],
          "24165": [
            37
          ],
          "24166": [
            38
          ],
          "24167": [
            39
          ],
          "24168": [
            40
          ],
          "24169": [
            41
          ],
          "24170": [
            42
          ],
          "24171": [
            43
          ],
          "24172": [
            44
          ],
          "24173": [
            45
          ],
          "24174": [
            46
          ],
          "24175": [
            47
          ]
        },
        "first": 0,
        "last": 47,
        "children": [
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 0,
            "last": 0,
            "children": [
              {
                "index": {},
                "first": 0,
                "last": 0,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24128"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 1,
            "last": 1,
            "children": [
              {
                "index": {},
                "first": 1,
                "last": 1,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24129"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 2,
            "last": 2,
            "children": [
              {
                "index": {},
                "first": 2,
                "last": 2,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24130"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 3,
            "last": 3,
            "children": [
              {
                "index": {},
                "first": 3,
                "last": 3,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24131"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 4,
            "last": 4,
            "children": [
              {
                "index": {},
                "first": 4,
                "last": 4,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24132"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 5,
            "last": 5,
            "children": [
              {
                "index": {},
                "first": 5,
                "last": 5,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24133"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 6,
            "last": 6,
            "children": [
              {
                "index": {},
                "first": 6,
                "last": 6,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24134"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 7,
            "last": 7,
            "children": [
              {
                "index": {},
                "first": 7,
                "last": 7,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24135"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 8,
            "last": 8,
            "children": [
              {
                "index": {},
                "first": 8,
                "last": 8,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24136"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 9,
            "last": 9,
            "children": [
              {
                "index": {},
                "first": 9,
                "last": 9,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24137"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 10,
            "last": 10,
            "children": [
              {
                "index": {},
                "first": 10,
                "last": 10,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24138"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 11,
            "last": 11,
            "children": [
              {
                "index": {},
                "first": 11,
                "last": 11,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24139"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 12,
            "last": 12,
            "children": [
              {
                "index": {},
                "first": 12,
                "last": 12,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24140"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 13,
            "last": 13,
            "children": [
              {
                "index": {},
                "first": 13,
                "last": 13,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24141"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 14,
            "last": 14,
            "children": [
              {
                "index": {},
                "first": 14,
                "last": 14,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24142"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 15,
            "last": 15,
            "children": [
              {
                "index": {},
                "first": 15,
                "last": 15,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24143"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 16,
            "last": 16,
            "children": [
              {
                "index": {},
                "first": 16,
                "last": 16,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24144"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 17,
            "last": 17,
            "children": [
              {
                "index": {},
                "first": 17,
                "last": 17,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24145"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 18,
            "last": 18,
            "children": [
              {
                "index": {},
                "first": 18,
                "last": 18,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24146"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 19,
            "last": 19,
            "children": [
              {
                "index": {},
                "first": 19,
                "last": 19,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24147"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 20,
            "last": 20,
            "children": [
              {
                "index": {},
                "first": 20,
                "last": 20,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24148"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 21,
            "last": 21,
            "children": [
              {
                "index": {},
                "first": 21,
                "last": 21,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24149"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 22,
            "last": 22,
            "children": [
              {
                "index": {},
                "first": 22,
                "last": 22,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24150"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 23,
            "last": 23,
            "children": [
              {
                "index": {},
                "first": 23,
                "last": 23,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24151"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 24,
            "last": 24,
            "children": [
              {
                "index": {},
                "first": 24,
                "last": 24,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24152"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 25,
            "last": 25,
            "children": [
              {
                "index": {},
                "first": 25,
                "last": 25,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24153"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 26,
            "last": 26,
            "children": [
              {
                "index": {},
                "first": 26,
                "last": 26,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24154"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 27,
            "last": 27,
            "children": [
              {
                "index": {},
                "first": 27,
                "last": 27,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24155"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 28,
            "last": 28,
            "children": [
              {
                "index": {},
                "first": 28,
                "last": 28,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24156"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 29,
            "last": 29,
            "children": [
              {
                "index": {},
                "first": 29,
                "last": 29,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24157"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 30,
            "last": 30,
            "children": [
              {
                "index": {},
                "first": 30,
                "last": 30,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24158"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 31,
            "last": 31,
            "children": [
              {
                "index": {},
                "first": 31,
                "last": 31,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24159"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 32,
            "last": 32,
            "children": [
              {
                "index": {},
                "first": 32,
                "last": 32,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24160"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 33,
            "last": 33,
            "children": [
              {
                "index": {},
                "first": 33,
                "last": 33,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24161"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 34,
            "last": 34,
            "children": [
              {
                "index": {},
                "first": 34,
                "last": 34,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24162"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 35,
            "last": 35,
            "children": [
              {
                "index": {},
                "first": 35,
                "last": 35,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24163"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 36,
            "last": 36,
            "children": [
              {
                "index": {},
                "first": 36,
                "last": 36,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24164"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 37,
            "last": 37,
            "children": [
              {
                "index": {},
                "first": 37,
                "last": 37,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24165"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 38,
            "last": 38,
            "children": [
              {
                "index": {},
                "first": 38,
                "last": 38,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24166"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 39,
            "last": 39,
            "children": [
              {
                "index": {},
                "first": 39,
                "last": 39,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24167"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 40,
            "last": 40,
            "children": [
              {
                "index": {},
                "first": 40,
                "last": 40,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24168"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 41,
            "last": 41,
            "children": [
              {
                "index": {},
                "first": 41,
                "last": 41,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24169"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 42,
            "last": 42,
            "children": [
              {
                "index": {},
                "first": 42,
                "last": 42,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24170"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 43,
            "last": 43,
            "children": [
              {
                "index": {},
                "first": 43,
                "last": 43,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24171"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 44,
            "last": 44,
            "children": [
              {
                "index": {},
                "first": 44,
                "last": 44,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24172"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 45,
            "last": 45,
            "children": [
              {
                "index": {},
                "first": 45,
                "last": 45,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24173"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 46,
            "last": 46,
            "children": [
              {
                "index": {},
                "first": 46,
                "last": 46,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24174"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 47,
            "last": 47,
            "children": [
              {
                "index": {},
                "first": 47,
                "last": 47,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24175"
          }
        ],
        "type": "root",
        "id": null
      },
      "lookups": [
        {
          "24128": "8/2010",
          "24129": "9/2010",
          "24130": "10/2010",
          "24131": "11/2010",
          "24132": "12/2010",
          "24133": "1/2011",
          "24134": "2/2011",
          "24135": "3/2011",
          "24136": "4/2011",
          "24137": "5/2011",
          "24138": "6/2011",
          "24139": "7/2011",
          "24140": "8/2011",
          "24141": "9/2011",
          "24142": "10/2011",
          "24143": "11/2011",
          "24144": "12/2011",
          "24145": "1/2012",
          "24146": "2/2012",
          "24147": "3/2012",
          "24148": "4/2012",
          "24149": "5/2012",
          "24150": "6/2012",
          "24151": "7/2012",
          "24152": "8/2012",
          "24153": "9/2012",
          "24154": "10/2012",
          "24155": "11/2012",
          "24156": "12/2012",
          "24157": "1/2013",
          "24158": "2/2013",
          "24159": "3/2013",
          "24160": "4/2013",
          "24161": "5/2013",
          "24162": "6/2013",
          "24163": "7/2013",
          "24164": "8/2013",
          "24165": "9/2013",
          "24166": "10/2013",
          "24167": "11/2013",
          "24168": "12/2013",
          "24169": "1/2014",
          "24170": "2/2014",
          "24171": "3/2014",
          "24172": "4/2014",
          "24173": "5/2014",
          "24174": "6/2014",
          "24175": "7/2014"
        },
        {
          "0": "Qtd. Pessoas (Cadastro)"
        }
      ]
    },
    "data": [
      [
        "140",
        "101",
        "13",
        "75",
        "39",
        "30",
        "27",
        "63",
        "46",
        "78",
        "86",
        "131",
        "139",
        "206",
        "391",
        "501",
        "627",
        "843",
        "965",
        "1067",
        "1439",
        "1764",
        "2001",
        "2153",
        "2971",
        "2709",
        "2919",
        "3063",
        "2881",
        "4452",
        "3854",
        "4428",
        "4322",
        "5824",
        "4927",
        "5831",
        "5949",
        "13093",
        "16047",
        "12979",
        "5512",
        "10346",
        "14237",
        "13973",
        "9700",
        "15638",
        "13025",
        "6913"
      ]
    ],
    "overall_size": {
      "columns": "48",
      "rows": "1"
    },
    "rows": {
      "tree": {
        "index": {
          "0": [
            0
          ]
        },
        "first": 0,
        "last": 0,
        "children": [
          {
            "index": {},
            "first": 0,
            "last": 0,
            "children": [],
            "type": "metric",
            "id": "0"
          }
        ],
        "type": "root",
        "id": null
      },
      "lookups": [
        {
          "0": "Qtd. Pessoas (Cadastro)"
        }
      ]
    },
    "offset": {
      "columns": 0,
      "rows": 0
    },
    "size": {
      "columns": 48,
      "rows": 1
    }
  }
}
JS

multi_series_json = <<-JS
{
  "xtab_data": {
    "columns": {
      "tree": {
        "index": {
          "24128": [
            0
          ],
          "24129": [
            1
          ],
          "24130": [
            2
          ],
          "24131": [
            3
          ],
          "24132": [
            4
          ],
          "24133": [
            5
          ],
          "24134": [
            6
          ],
          "24135": [
            7
          ],
          "24136": [
            8
          ],
          "24137": [
            9
          ],
          "24138": [
            10
          ],
          "24139": [
            11
          ],
          "24140": [
            12
          ],
          "24141": [
            13
          ],
          "24142": [
            14
          ],
          "24143": [
            15
          ],
          "24144": [
            16
          ],
          "24145": [
            17
          ],
          "24146": [
            18
          ],
          "24147": [
            19
          ],
          "24148": [
            20
          ],
          "24149": [
            21
          ],
          "24150": [
            22
          ],
          "24151": [
            23
          ],
          "24152": [
            24
          ],
          "24153": [
            25
          ],
          "24154": [
            26
          ],
          "24155": [
            27
          ],
          "24156": [
            28
          ],
          "24157": [
            29
          ],
          "24158": [
            30
          ],
          "24159": [
            31
          ],
          "24160": [
            32
          ],
          "24161": [
            33
          ],
          "24162": [
            34
          ],
          "24163": [
            35
          ],
          "24164": [
            36
          ],
          "24165": [
            37
          ],
          "24166": [
            38
          ],
          "24167": [
            39
          ],
          "24168": [
            40
          ],
          "24169": [
            41
          ],
          "24170": [
            42
          ],
          "24171": [
            43
          ],
          "24172": [
            44
          ],
          "24173": [
            45
          ],
          "24174": [
            46
          ],
          "24175": [
            47
          ]
        },
        "first": 0,
        "last": 47,
        "children": [
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 0,
            "last": 0,
            "children": [
              {
                "index": {},
                "first": 0,
                "last": 0,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24128"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 1,
            "last": 1,
            "children": [
              {
                "index": {},
                "first": 1,
                "last": 1,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24129"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 2,
            "last": 2,
            "children": [
              {
                "index": {},
                "first": 2,
                "last": 2,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24130"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 3,
            "last": 3,
            "children": [
              {
                "index": {},
                "first": 3,
                "last": 3,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24131"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 4,
            "last": 4,
            "children": [
              {
                "index": {},
                "first": 4,
                "last": 4,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24132"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 5,
            "last": 5,
            "children": [
              {
                "index": {},
                "first": 5,
                "last": 5,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24133"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 6,
            "last": 6,
            "children": [
              {
                "index": {},
                "first": 6,
                "last": 6,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24134"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 7,
            "last": 7,
            "children": [
              {
                "index": {},
                "first": 7,
                "last": 7,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24135"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 8,
            "last": 8,
            "children": [
              {
                "index": {},
                "first": 8,
                "last": 8,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24136"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 9,
            "last": 9,
            "children": [
              {
                "index": {},
                "first": 9,
                "last": 9,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24137"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 10,
            "last": 10,
            "children": [
              {
                "index": {},
                "first": 10,
                "last": 10,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24138"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 11,
            "last": 11,
            "children": [
              {
                "index": {},
                "first": 11,
                "last": 11,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24139"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 12,
            "last": 12,
            "children": [
              {
                "index": {},
                "first": 12,
                "last": 12,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24140"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 13,
            "last": 13,
            "children": [
              {
                "index": {},
                "first": 13,
                "last": 13,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24141"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 14,
            "last": 14,
            "children": [
              {
                "index": {},
                "first": 14,
                "last": 14,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24142"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 15,
            "last": 15,
            "children": [
              {
                "index": {},
                "first": 15,
                "last": 15,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24143"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 16,
            "last": 16,
            "children": [
              {
                "index": {},
                "first": 16,
                "last": 16,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24144"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 17,
            "last": 17,
            "children": [
              {
                "index": {},
                "first": 17,
                "last": 17,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24145"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 18,
            "last": 18,
            "children": [
              {
                "index": {},
                "first": 18,
                "last": 18,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24146"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 19,
            "last": 19,
            "children": [
              {
                "index": {},
                "first": 19,
                "last": 19,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24147"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 20,
            "last": 20,
            "children": [
              {
                "index": {},
                "first": 20,
                "last": 20,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24148"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 21,
            "last": 21,
            "children": [
              {
                "index": {},
                "first": 21,
                "last": 21,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24149"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 22,
            "last": 22,
            "children": [
              {
                "index": {},
                "first": 22,
                "last": 22,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24150"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 23,
            "last": 23,
            "children": [
              {
                "index": {},
                "first": 23,
                "last": 23,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24151"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 24,
            "last": 24,
            "children": [
              {
                "index": {},
                "first": 24,
                "last": 24,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24152"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 25,
            "last": 25,
            "children": [
              {
                "index": {},
                "first": 25,
                "last": 25,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24153"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 26,
            "last": 26,
            "children": [
              {
                "index": {},
                "first": 26,
                "last": 26,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24154"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 27,
            "last": 27,
            "children": [
              {
                "index": {},
                "first": 27,
                "last": 27,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24155"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 28,
            "last": 28,
            "children": [
              {
                "index": {},
                "first": 28,
                "last": 28,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24156"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 29,
            "last": 29,
            "children": [
              {
                "index": {},
                "first": 29,
                "last": 29,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24157"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 30,
            "last": 30,
            "children": [
              {
                "index": {},
                "first": 30,
                "last": 30,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24158"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 31,
            "last": 31,
            "children": [
              {
                "index": {},
                "first": 31,
                "last": 31,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24159"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 32,
            "last": 32,
            "children": [
              {
                "index": {},
                "first": 32,
                "last": 32,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24160"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 33,
            "last": 33,
            "children": [
              {
                "index": {},
                "first": 33,
                "last": 33,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24161"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 34,
            "last": 34,
            "children": [
              {
                "index": {},
                "first": 34,
                "last": 34,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24162"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 35,
            "last": 35,
            "children": [
              {
                "index": {},
                "first": 35,
                "last": 35,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24163"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 36,
            "last": 36,
            "children": [
              {
                "index": {},
                "first": 36,
                "last": 36,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24164"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 37,
            "last": 37,
            "children": [
              {
                "index": {},
                "first": 37,
                "last": 37,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24165"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 38,
            "last": 38,
            "children": [
              {
                "index": {},
                "first": 38,
                "last": 38,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24166"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 39,
            "last": 39,
            "children": [
              {
                "index": {},
                "first": 39,
                "last": 39,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24167"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 40,
            "last": 40,
            "children": [
              {
                "index": {},
                "first": 40,
                "last": 40,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24168"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 41,
            "last": 41,
            "children": [
              {
                "index": {},
                "first": 41,
                "last": 41,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24169"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 42,
            "last": 42,
            "children": [
              {
                "index": {},
                "first": 42,
                "last": 42,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24170"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 43,
            "last": 43,
            "children": [
              {
                "index": {},
                "first": 43,
                "last": 43,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24171"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 44,
            "last": 44,
            "children": [
              {
                "index": {},
                "first": 44,
                "last": 44,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24172"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 45,
            "last": 45,
            "children": [
              {
                "index": {},
                "first": 45,
                "last": 45,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24173"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 46,
            "last": 46,
            "children": [
              {
                "index": {},
                "first": 46,
                "last": 46,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24174"
          },
          {
            "index": {
              "0": [
                0
              ]
            },
            "first": 47,
            "last": 47,
            "children": [
              {
                "index": {},
                "first": 47,
                "last": 47,
                "children": [],
                "type": "metric",
                "id": "0"
              }
            ],
            "type": "normal",
            "id": "24175"
          }
        ],
        "type": "root",
        "id": null
      },
      "lookups": [
        {
          "24128": "Aug 2010",
          "24129": "Sep 2010",
          "24130": "Oct 2010",
          "24131": "Nov 2010",
          "24132": "Dec 2010",
          "24133": "Jan 2011",
          "24134": "Feb 2011",
          "24135": "Mar 2011",
          "24136": "Apr 2011",
          "24137": "May 2011",
          "24138": "Jun 2011",
          "24139": "Jul 2011",
          "24140": "Aug 2011",
          "24141": "Sep 2011",
          "24142": "Oct 2011",
          "24143": "Nov 2011",
          "24144": "Dec 2011",
          "24145": "Jan 2012",
          "24146": "Feb 2012",
          "24147": "Mar 2012",
          "24148": "Apr 2012",
          "24149": "May 2012",
          "24150": "Jun 2012",
          "24151": "Jul 2012",
          "24152": "Aug 2012",
          "24153": "Sep 2012",
          "24154": "Oct 2012",
          "24155": "Nov 2012",
          "24156": "Dec 2012",
          "24157": "Jan 2013",
          "24158": "Feb 2013",
          "24159": "Mar 2013",
          "24160": "Apr 2013",
          "24161": "May 2013",
          "24162": "Jun 2013",
          "24163": "Jul 2013",
          "24164": "Aug 2013",
          "24165": "Sep 2013",
          "24166": "Oct 2013",
          "24167": "Nov 2013",
          "24168": "Dec 2013",
          "24169": "Jan 2014",
          "24170": "Feb 2014",
          "24171": "Mar 2014",
          "24172": "Apr 2014",
          "24173": "May 2014",
          "24174": "Jun 2014",
          "24175": "Jul 2014"
        },
        {
          "0": "Qtd. Mudanças de estágio"
        }
      ]
    },
    "data": [
      [
        "136",
        "100",
        "13",
        "71",
        "36",
        "29",
        "27",
        "62",
        "45",
        "76",
        "84",
        "124",
        "134",
        "195",
        "367",
        "465",
        "585",
        "761",
        "876",
        "971",
        "1351",
        "1667",
        "1873",
        "2059",
        "2826",
        "2609",
        "2917",
        "3032",
        "2876",
        "4329",
        "3799",
        "4363",
        "4255",
        "5341",
        "4863",
        "5754",
        "5882",
        "12630",
        "15864",
        "8432",
        "5276",
        "9909",
        "14448",
        "12209",
        "9719",
        "18464",
        "14938",
        "7108"
      ],
      [
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        "25",
        "67",
        "64",
        "30",
        "55",
        "24",
        "11",
        "2"
      ],
      [
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        "1",
        null,
        null,
        null,
        null,
        null,
        "2",
        "7",
        "22",
        "38",
        "50",
        "60",
        "63",
        "116",
        "100",
        "91",
        "99",
        "167",
        "158",
        "232",
        "156",
        "234",
        "303",
        "240",
        "230",
        "403",
        "872",
        "1167",
        "1362",
        "1445",
        "1455",
        "1244"
      ],
      [
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        "7",
        "116",
        "320",
        "79",
        "358",
        "210",
        "1443",
        "753"
      ],
      [
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        "6",
        "54",
        "63",
        "75",
        "135",
        "104",
        "176",
        "57"
      ],
      [
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        null,
        "25",
        "99",
        "44",
        "51",
        "63",
        "301",
        "222",
        "143"
      ]
    ],
    "overall_size": {
      "columns": "48",
      "rows": "6"
    },
    "rows": {
      "tree": {
        "index": {
          "6": [
            0
          ],
          "113": [
            1
          ],
          "12940": [
            3
          ],
          "222252": [
            4
          ],
          "470094": [
            5
          ],
          "470095": [
            2
          ]
        },
        "first": 0,
        "last": 5,
        "children": [
          {
            "index": {},
            "first": 0,
            "last": 0,
            "children": [],
            "type": "normal",
            "id": "6"
          },
          {
            "index": {},
            "first": 1,
            "last": 1,
            "children": [],
            "type": "normal",
            "id": "113"
          },
          {
            "index": {},
            "first": 2,
            "last": 2,
            "children": [],
            "type": "normal",
            "id": "470095"
          },
          {
            "index": {},
            "first": 3,
            "last": 3,
            "children": [],
            "type": "normal",
            "id": "12940"
          },
          {
            "index": {},
            "first": 4,
            "last": 4,
            "children": [],
            "type": "normal",
            "id": "222252"
          },
          {
            "index": {},
            "first": 5,
            "last": 5,
            "children": [],
            "type": "normal",
            "id": "470094"
          }
        ],
        "type": "root",
        "id": null
      },
      "lookups": [
        {
          "6": "Lead",
          "113": "Lead Qualificado",
          "12940": "Cliente",
          "222252": "Venda",
          "470094": "Oportunidade Perdida",
          "470095": "Oportunidade"
        }
      ]
    },
    "offset": {
      "columns": 0,
      "rows": 0
    },
    "size": {
      "columns": 48,
      "rows": 6
    }
  }
}
JS

describe GooderData::Project::Report::Series do
  describe ".parse" do
    subject(:parse) { GooderData::Project::Report::Series.parse(JSON.parse(json)) }

    context "when there are only one series" do
      let(:json) { one_serie_json }
      let(:series) { parse.first }

      it "should have size one" do
        expect(parse.size).to eq 1
      end

      describe "#name" do
        subject(:name) { series.name }

        it "should have the name of the series" do
          expect(name).to eq "Qtd. Pessoas (Cadastro)"
        end
      end

      describe "#data" do
        subject(:data) { series.data }

        context "when the given x value is present in the series x axis" do
          [
            ['1/2014', '10346'],
            ['2/2014', '14237'],
            ['3/2014', '13973'],
            ['4/2014', '9700'],
            ['5/2014', '15638'],
            ['6/2014', '13025']
          ].each do |x, y|
            it "should return the y value of that point" do
              expect(data[x]).to eq y
            end
          end

        end
      end
    end

    context "when there are multiple series" do
      let(:json) { multi_series_json }
      let(:series) { parse }

      it "should have the correct size of series" do
        expect(parse.size).to eq 6
      end

      describe "#data" do
        subject(:data) { series.first.data }

        context "when the given x value is present in the series x axis" do
          [
            ['Aug 2010', '136'],
            ['Sep 2010', '100'],
            ['Oct 2010', '13'],
            ['Nov 2010', '71'],
            ['Dec 2010', '36'],
            ['Jan 2011', '29'],
            ['Feb 2011', '27'],
            ['Mar 2011', '62'],
            ['Apr 2011', '45'],
            ['May 2011', '76'],
            ['Jun 2011', '84'],
            ['Jul 2011', '124'],
            ['Aug 2011', '134']
          ].each do |x, y|
            it "should return the y value of that point" do
              expect(data[x]).to eq y
            end
          end

        end
      end
    end

  end
end
